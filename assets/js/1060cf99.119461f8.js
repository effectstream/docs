"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[1267],{4421:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/1100-layers-d799c6f60c61756424c1c8bc9bd80336.png"},5475:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/1100-gm-0d51d7f01b525471314b5fedfe9784cb.png"},5691:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/1100-players-in-area-da57749a92558cd910d14fea6833a701.png"},6613:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>o});var a=t(1491);const i={},r=a.createContext(i);function s(e){const n=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),a.createElement(r.Provider,{value:n},e.children)}},9591:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"home/example-tarochi/example-tarochi","title":"Tarochi","description":"Tarochi is an online decentralized, on-chain, autonomous, Web3 game developed entirely with Effectstream.","source":"@site/docs/home/1100-example-tarochi/1100-example-tarochi.md","sourceDirName":"home/1100-example-tarochi","slug":"/home/example-tarochi/","permalink":"/paima-v-next-docs/home/example-tarochi/","draft":false,"unlisted":false,"editUrl":"https://github.com/PaimaStudios/paima-engine-docs/tree/main/docs/home/1100-example-tarochi/1100-example-tarochi.md","tags":[],"version":"current","sidebarPosition":1100,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Contributing to Effectstream","permalink":"/paima-v-next-docs/home/paima-engine/contributions"},"next":{"title":"EVM-Midnight Template","permalink":"/paima-v-next-docs/home/templates/evm-midnight"}}');var i=t(2531),r=t(6613);const s={},o="Tarochi",l={},c=[{value:"Game Engine: GameMaker &amp; Web3 Integration",id:"game-engine-gamemaker--web3-integration",level:2},{value:"Connecting GameMaker with JavaScript",id:"connecting-gamemaker-with-javascript",level:3},{value:"Architecture &amp; Tokenomics",id:"architecture--tokenomics",level:2},{value:"The Role of TGOLD",id:"the-role-of-tgold",level:3},{value:"In-Game Assets",id:"in-game-assets",level:3},{value:"General Rules:",id:"general-rules",level:3},{value:"Exchanges and DEX:",id:"exchanges-and-dex",level:3},{value:"Contracts",id:"contracts",level:2},{value:"Frontend &amp; Wallets",id:"frontend--wallets",level:2},{value:"State Machine",id:"state-machine",level:2},{value:"Grammar",id:"grammar",level:2},{value:"Processes",id:"processes",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"tarochi",children:"Tarochi"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Tarochi"})," is an online decentralized, on-chain, autonomous, Web3 game developed entirely with ",(0,i.jsx)(n.code,{children:"Effectstream"}),"."]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Decentralized"}),": The game runs on a decentralized network of nodes, and is not owned or controlled by a single entity.",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"On-chain"}),": The game is built on top of the blockchain, and all game data is stored on the blockchain.",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Autonomous"}),": The game is self-governed and self-sustaining, without the need for external intervention.",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Web3"}),": The game is built on top of blockchains, wallets, smart-contracts and other Web3 technologies."]}),"\n"]}),"\n",(0,i.jsx)("iframe",{src:"https://drive.google.com/file/d/1--jE8nVOyhrPqh5IWmahys2aCrKn23aI/preview",width:"640",height:"480",allow:"autoplay"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"This is a development stage video of the game"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["This guide is intended as a practical example of how a complex, fully on-chain game can be developed using ",(0,i.jsx)(n.code,{children:"Effectstream"}),"."]}),"\n",(0,i.jsx)(n.h1,{id:"game-design",children:"Game Design"}),"\n",(0,i.jsx)(n.p,{children:"We will not deep-dive into the game loop design, but rather focus on important architectural and economic decisions you need to make for a decentralized blockchain game."}),"\n",(0,i.jsx)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/Rug2xtaq-7c?si=lBGH0HN0QC-dcdWC",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerpolicy:"strict-origin-when-cross-origin",allowfullscreen:!0}),"\n",(0,i.jsx)(n.h2,{id:"game-engine-gamemaker--web3-integration",children:"Game Engine: GameMaker & Web3 Integration"}),"\n",(0,i.jsxs)(n.p,{children:["Tarochi was built using ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"https://gamemaker.io/",children:"GameMaker"})}),", a beginner-to-advanced friendly tool for creating 2D experiences. While renowned for its intuitive interface, GameMaker's reliance on its proprietary GameMaker Language (GML) has historically made it difficult to integrate with the JavaScript-heavy world of Web3."]}),"\n",(0,i.jsx)(n.p,{children:"To bridge this gap, Effectstream provides a template and adapter for GameMaker, allowing developers to connect their GML code to JavaScript. This enables the use of Effectstream's state machine framework for on-chain game logic while leveraging GameMaker for UI and multi-platform support (desktop, mobile, consoles, and browsers)."}),"\n",(0,i.jsx)("iframe",{width:"100%",height:"440",src:"https://www.youtube.com/embed/ePhIU1Hla-g?si=OTpnPs_MsNBS-sjZ",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerpolicy:"strict-origin-when-cross-origin",allowfullscreen:!0}),"\n",(0,i.jsx)(n.h3,{id:"connecting-gamemaker-with-javascript",children:"Connecting GameMaker with JavaScript"}),"\n",(0,i.jsx)(n.p,{children:"Nearly all Web3 tools are written in or compatible with JavaScript, primarily because crypto wallets are most commonly used as browser extensions. GameMaker's ability to compile games to HTML5 makes it a viable choice for web-based dApps."}),"\n",(0,i.jsx)(n.p,{children:"Our GameMaker template introduces a custom-built adapter that allows GML code to call JavaScript functions and receive callbacks from them. This enables a GameMaker application to handle everything from wallet connections to direct interactions with Effectstream and other Web3 libraries."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(5475).A+"",width:"677",height:"403"})}),"\n",(0,i.jsx)(n.p,{children:"This adapter is not limited to Web3. In Tarochi, the same concept was used to build menus and overlays using the popular frontend framework Vue.js, demonstrating the flexibility of this approach."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(5691).A+"",width:"2130",height:"1196"})}),"\n",(0,i.jsx)(n.h2,{id:"architecture--tokenomics",children:"Architecture & Tokenomics"}),"\n",(0,i.jsxs)(n.p,{children:["Tarochi's architecture is a multi-layered stack designed for massive scalability, allowing it to handle over ",(0,i.jsx)(n.strong,{children:"1 million transactions in less than 100 hours"})," post-launch. Transactions are fast and cheap enough for the team to subsidize gas fees for all players."]}),"\n",(0,i.jsx)(n.p,{children:"The stack is layered as follows:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"L1: Ethereum"})," (Primary settlement layer)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"L2: Arbitrum"})," (For liquidity and DEX interactions)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"L3: Xai"})," (For fast, low-cost data availability and game actions)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"L4: Tarochi"})," (The game's sovereign rollup, built with Effectstream)"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Effectstream allows Tarochi to be a non-EVM application, enabling a more complex and dynamic world while maintaining decentralization. It achieves this by simultaneously monitoring multiple chains (Arbitrum, Xai, and Cardano), leveraging the low costs of Xai for gameplay while tapping into the liquidity of Arbitrum for its tokens and NFTs."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(4421).A+"",width:"878",height:"878"})}),"\n",(0,i.jsx)(n.h3,{id:"the-role-of-tgold",children:"The Role of TGOLD"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"TGOLD"})," is the native token for the Tarochi L4 autonomous world and is used for in-game economic activities, such as purchasing items. While TGOLD powers the L4's economy, it is made tradable on Arbitrum One through a custom DEX."]}),"\n",(0,i.jsx)(n.p,{children:"Trades made on the Arbitrum DEX are reflected directly in the Tarochi L4 without requiring a traditional bridge. This is possible because Effectstream monitors both chains. However, this architecture means TGOLD cannot be traded in standard AMMs like Uniswap, as they are not aware of the L4 connection."}),"\n",(0,i.jsx)(n.h3,{id:"in-game-assets",children:"In-Game Assets"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["ERC1155 ",(0,i.jsx)(n.code,{children:"Gold"})," (TGOLD)"]}),": The primary in-game currency, convertible to its on-chain representation on Arbitrum."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["ERC721 ",(0,i.jsx)(n.code,{children:"Trainer"})," Assets"]}),": Limited supply NFTs that provide in-game benefits if held in the player's wallet."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["ERC721 ",(0,i.jsx)(n.code,{children:"Monsters"})]}),": Can be minted on-chain or captured in-game and are convertible between their on-chain and in-game forms."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"Items"})}),": These exist only within the L4 game state and are not on-chain assets."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"general-rules",children:"General Rules:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Common monsters are unlimited."}),"\n",(0,i.jsx)(n.li,{children:"Rare+ monsters are limited by time."}),"\n",(0,i.jsx)(n.li,{children:'Monsters are "sacrificed" to increase their max level.'}),"\n",(0,i.jsx)(n.li,{children:"Gold is consumed when used in a store."}),"\n",(0,i.jsx)(n.li,{children:"A limited amount of new Gold was minted."}),"\n",(0,i.jsx)(n.li,{children:"Trainers are limited."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"exchanges-and-dex",children:"Exchanges and DEX:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Gold, Trainers, and Monsters were available to mint on EVM and partially on Cardano."}),"\n",(0,i.jsx)(n.li,{children:"NFT marketplaces like OpenSea and Jpg.store were used for Monster and Trainer exchanges."}),"\n",(0,i.jsx)(n.li,{children:"The Effectstream DEX on Arbitrum was used for trading Gold."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"contracts",children:"Contracts"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"Effectstream L2"})}),": This contract is extensively used for submitting game inputs. It runs on the XAI network for its fast block time and low gas fees."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"IInverseAppProjectedNft"})}),": Standard ERC721, with the ability to represent L4 assets as NFTs on L1."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"IInverseAppProjected1155"})}),": Standard ERC1155, with the ability to represent L4 fungible/semi-fungible assets on L1."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"IOrderbookDex"})}),": TGold DEX Contract."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"frontend--wallets",children:"Frontend & Wallets"}),"\n",(0,i.jsxs)(n.p,{children:["To interact with the ",(0,i.jsx)(n.code,{children:"Effectstream L2"})," contract, the game used a browser EVM Wallet and sent transactions to the batcher. Players could connect their real EVM or Cardano wallets to mint monsters, use trainer effects, and perform other actions requiring a signature."]}),"\n",(0,i.jsx)(n.h2,{id:"state-machine",children:"State Machine"}),"\n",(0,i.jsxs)(n.p,{children:["The Tarochi ",(0,i.jsx)(n.code,{children:"State Machine"})," is a set of triggers that react to on-chain events, such as a Monster mint or Gold transfer, but primarily to inputs submitted via the ",(0,i.jsx)(n.code,{children:"Effectstream L2"})," Contract. Each keyword in the ",(0,i.jsx)(n.code,{children:"grammar"})," is implemented as a ",(0,i.jsx)(n.code,{children:"State Transition Function"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"useItem = @c|item|argument?"}),": This STF first checks if the user has the item and is in a valid state to use it (e.g., not in battle). If all rules pass, it deducts the item and applies its effects."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fastTravel = @f|x|y"}),": This STF checks if the user can fast travel, verifies the target coordinates, moves the player to the new map, and updates any zone-specific effects."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"grammar",children:"Grammar"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Important: This is Effectstream V1 Grammar, so it's slightly different from the new Effectstream V2 Grammar, but it represents the same concepts."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"join                    = @j|referrer?\nsetReferrer             = @k|referrer\nrename                  = @rn|*name|fee_wallet\nmoveToArea              = @m|x|y\nfastTravel              = @f|x|y\nbattleCommand           = @b|battleType|round|action|action_data?\nswitchMonsters          = @x|swap_commands\nstartPVEBattle          = @e|npc_trainer_global_id\nstartPVPBattle          = @p|*player|battle_type?\nhealCenter              = @h|\nuseItem                 = @c|item|argument?\npurchaseItem            = @r|item|count?|fee_wallet\nbarter                  = @t|give|amount|receive\nexcavate                = @z|use_item\nclaim                   = g|\nredeem                  = @w|blockHeight\nmerge                   = @q|monster_target|monsters\nmergeTGold              = @qt|monster_target|fee_wallet\nnop                     = n|\narenaBattle             = @n|arena_id\ninternalCommands        = @a|cmd|id?|args?\nbuyCaptureItem          = @i|*player\nscheduleRandomEncounter = w|*player|x|y\nscheduleDaily           = d|tick\nscheduleHourly          = h|tick\nscheduleQuarterHour     = q|tick\nscheduleNoAction        = x|blockHeight|battleType|round|wallet_a|wallet_b\nscheduleStatusEffect    = s|*player|item_id|monster_id?\nsendGold                = @s|to_player|amount|signature|fee_wallet\nlockGold                = @l|amount\nsendMonster             = @u|to_player|monster_id|signature|fee_wallet\nappMonsterLock          = @d|monster_id|fee_wallet\nmonster_lock            = monster_lock|payload\nmonster_burn            = monster_burn|payload\nmonster_transfer        = monster_transfer|address|nft_id|data?\ndelegate                = &wd|from?|to?|from_signature|to_signature\nmigrate                 = &wm|from?|to?|from_signature|to_signature\ncancelDelegations       = &wc|to?\ncreateEventTeam         = @ev|event_id\ninteractEventTeam       = @ei|action|*team_id|data?\nevent_step              = event_step|event_id|step\nevent_end               = event_end|event_id\ncreateGuild             = @gc|name|social_link|fee_wallet\ninteractGuild           = @gi|action|*guild_id|data?\nbuyForGuild             = @gs|action|*guild_id|fee_wallet\ngold_mint               = gold_mint|payload\ngold_burn               = gold_burn|operator|from|ids|values\nacceptDaily             = @da|*daily_id\nforSaleDaily            = @ds|*daily_id|price\ncancelDaily             = @dc|*daily_id\npurchaseDaily           = @dp|*daily_id|fee_wallet\nscheduleDailyQuestEnd   = dq|*daily_id\nmasterDaily             = @dm|action|payload\ngiveItem                = i|message|item_id|signature|wallets\ndex_order_created       = dex_order_created|payload\ndex_order_cancelled     = dex_order_cancelled|payload\ndex_order_filled        = dex_order_filled|payload\nupdateCardanoLink       = @co|token|address\n"})}),"\n",(0,i.jsx)(n.h2,{id:"processes",children:"Processes"}),"\n",(0,i.jsx)(n.p,{children:"For the development of Tarochi, the following processes need to be run:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"EVM Main Chain with fast block times (emulating XAI) + RPC"}),"\n",(0,i.jsx)(n.li,{children:"EVM Parallel Chain (emulating Arbitrum) + RPC"}),"\n",(0,i.jsx)(n.li,{children:"Cardano Parallel Chain"}),"\n",(0,i.jsx)(n.li,{children:"Game and Token Smart Contracts"}),"\n",(0,i.jsx)(n.li,{children:"Database (Postgres)"}),"\n",(0,i.jsx)(n.li,{children:"Batcher (to allow users to submit transactions to the Effectstream L2 contract without paying for gas or having a wallet)"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);