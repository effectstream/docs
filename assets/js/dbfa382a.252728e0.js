"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[8512],{440:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"home/components/accounts","title":"Accounts","description":"Beyond simple wallet addresses, Paima Engine provides a flexible, L2-native Account System. This system acts as a form of L2 Account Abstraction, allowing you to create a persistent user identity that is more robust and user-friendly than a single private key.","source":"@site/docs/home/100-components/116-accounts.md","sourceDirName":"home/100-components","slug":"/home/components/accounts","permalink":"/paima-v-next-docs/home/components/accounts","draft":false,"unlisted":false,"editUrl":"https://github.com/PaimaStudios/paima-engine-docs/tree/main/docs/home/100-components/116-accounts.md","tags":[],"version":"current","sidebarPosition":116,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Frontend (dApp)","permalink":"/paima-v-next-docs/home/components/frontend"},"next":{"title":"Node Startup","permalink":"/paima-v-next-docs/home/components/node-startup"}}');var i=s(2531),t=s(6613);const a={},d="Accounts",c={},o=[{value:"Core Concepts",id:"core-concepts",level:3},{value:"Managing Accounts via Built-in Commands",id:"managing-accounts-via-built-in-commands",level:3},{value:"<code>&amp;createAccount</code>",id:"createaccount",level:4},{value:"<code>&amp;linkAddress</code>",id:"linkaddress",level:4},{value:"<code>&amp;unlinkAddress</code>",id:"unlinkaddress",level:4},{value:"Querying Account Data",id:"querying-account-data",level:3}];function l(e){const n={a:"a",code:"code",em:"em",h1:"h1",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"accounts",children:"Accounts"})}),"\n",(0,i.jsxs)(n.p,{children:["Beyond simple wallet addresses, Paima Engine provides a flexible, L2-native ",(0,i.jsx)(n.strong,{children:"Account System"}),". This system acts as a form of L2 Account Abstraction, allowing you to create a persistent user identity that is more robust and user-friendly than a single private key."]}),"\n",(0,i.jsx)(n.p,{children:"The primary goal of the Account System is to decouple a user's in-game identity from a single wallet. This enables powerful features like:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Multi-Wallet Control"}),': A single Paima Account can be controlled by multiple addresses. For example, a user could link a secure hardware wallet (a "cold wallet") and a more convenient browser extension (a "hot wallet") to the same game account.']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Account Recovery"}),": If a user loses access to their primary wallet, they can use a previously linked secondary wallet to regain control of their account by assigning a new primary address."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Seamless Wallet Migration"}),": Users can switch their primary wallet without losing their in-game progress, assets, or identity."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,i.jsx)(n.p,{children:"The system is built on two simple but powerful concepts, which are reflected in the underlying database tables."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Account"}),": This is the central identity, represented by a unique, auto-incrementing ",(0,i.jsx)(n.code,{children:"account_id"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Address"}),": This is a standard blockchain wallet address (e.g., an EVM or Cardano address)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Primary Address"}),": Each Account has one designated ",(0,i.jsx)(n.strong,{children:"Primary Address"}),'. This address acts as the "owner" or "administrator" of the account and is the only one authorized to perform sensitive actions, such as linking new addresses or removing existing ones.']}),"\n"]}),"\n",(0,i.jsx)(n.mermaid,{value:'erDiagram\n    ACCOUNT {\n        int id PK\n        string primary_address FK\n    }\n    ADDRESS {\n        string address PK\n        int account_id FK\n    }\n    ACCOUNT ||--o{ ADDRESS : "links"'}),"\n",(0,i.jsx)(n.h3,{id:"managing-accounts-via-built-in-commands",children:"Managing Accounts via Built-in Commands"}),"\n",(0,i.jsxs)(n.p,{children:["You do not need to write any custom STFs to manage accounts. Paima Engine provides a suite of built-in ",(0,i.jsx)(n.a,{href:"/paima-v-next-docs/home/components/grammar",children:"Grammar"})," commands that you can call directly through the ",(0,i.jsx)(n.code,{children:"PaimaL2Contract"}),". All administrative actions are secured by cryptographic signatures."]}),"\n",(0,i.jsx)(n.h4,{id:"createaccount",children:(0,i.jsx)(n.code,{children:"&createAccount"})}),"\n",(0,i.jsx)(n.p,{children:"This is the entry point for creating a new Paima Account."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Creates a new, empty account."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logic"}),": When a wallet sends this command, the engine creates a new ",(0,i.jsx)(n.code,{children:"account"})," row. The sender's address is automatically set as the first linked address and the ",(0,i.jsx)(n.strong,{children:"Primary Address"})," for the new account."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Grammar"}),": ",(0,i.jsx)(n.code,{children:'["&createAccount"]'})]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"linkaddress",children:(0,i.jsx)(n.code,{children:"&linkAddress"})}),"\n",(0,i.jsx)(n.p,{children:"This command links a new wallet address to an existing account."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": To add a new controlling wallet to an account."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Security Model"}),": This is a sensitive operation and is secured by a ",(0,i.jsx)(n.strong,{children:"two-signature requirement"}),":","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["A signature from the ",(0,i.jsx)(n.strong,{children:"current Primary Address"})," is required to prove that the sender has the authority to modify the account."]}),"\n",(0,i.jsxs)(n.li,{children:["A signature from the ",(0,i.jsx)(n.strong,{children:"new Address being linked"})," is required to prove that its owner consents to being added to the account."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Grammar"}),": ",(0,i.jsx)(n.code,{children:'["&linkAddress", account_id, signature_from_primary, primary_address_type, new_address, signature_from_new_address, secondary_address_type, is_new_primary]'})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Parameters"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"account_id"})," (number): The ID of the account to modify."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"signature_from_primary"})," (string): The signature from the current primary wallet."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"primary_address_type"}),": (AddressType) Numeric type of address."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"new_address"})," (string): The new wallet address to link."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"signature_from_new_address"})," (string): The signature from the new wallet."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"secondary_address_type"}),": (AddressType): Numeric type of address"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"is_new_primary"})," (boolean): If ",(0,i.jsx)(n.code,{children:"true"}),", the ",(0,i.jsx)(n.code,{children:"new_address"})," will become the new Primary Address for the account."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"unlinkaddress",children:(0,i.jsx)(n.code,{children:"&unlinkAddress"})}),"\n",(0,i.jsx)(n.p,{children:"This command removes a wallet address from an account. The logic for this command is contextual, depending on who initiates it."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": To remove a wallet's control over an account."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Grammar"}),": ",(0,i.jsx)(n.code,{children:'["&unlinkAddress", account_id, signature_from_primary,  primary_address_type, target_address, new_primary]'})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"There are two ways this command can be used:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Administrative Unlink (by Primary Address)"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logic"}),": The Primary Address can remove any other linked address from the account."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Requirements"}),": This requires a valid ",(0,i.jsx)(n.code,{children:"signature_from_primary"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"new_primary"})}),": If the address being unlinked is the current Primary Address, the ",(0,i.jsx)(n.code,{children:"new_primary"})," parameter ",(0,i.jsx)(n.em,{children:"must"})," be provided to designate one of the remaining linked addresses as the new owner."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Self Unlink (by a linked Address)"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logic"}),": Any linked address can remove itself from an account."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Requirements"}),": The ",(0,i.jsx)(n.code,{children:"signature_from_primary"})," parameter is left as an empty string. The sender's address must match the ",(0,i.jsx)(n.code,{children:"target_address"})," being unlinked."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Safety Precaution"}),": A user ",(0,i.jsx)(n.strong,{children:"cannot"}),' unlink themselves if they are the Primary Address and other addresses are still linked to the account. This prevents the account from being "orphaned" without an administrator. To change the primary, they must first use ',(0,i.jsx)(n.code,{children:"&linkAddress"})," to set a new primary or use the administrative unlink flow."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Check the ",(0,i.jsx)(n.a,{href:"/paima-v-next-docs/home/components/wallets",children:"AddressTypes in the Wallets Section"})]}),"\n",(0,i.jsx)(n.h3,{id:"querying-account-data",children:"Querying Account Data"}),"\n",(0,i.jsxs)(n.p,{children:["The Paima Engine automatically creates and populates the necessary database tables. You can query this data from your custom API endpoints or within your STFs using the provided ",(0,i.jsx)(n.code,{children:"pgtyped"})," functions."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Database Schema:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE paima.accounts (\n  id SERIAL PRIMARY KEY,\n  primary_address TEXT\n);\n\nCREATE TABLE paima.addresses (\n  address TEXT NOT NULL UNIQUE,\n  account_id INTEGER REFERENCES paima.accounts(id)\n);\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["Common Queries (",(0,i.jsx)(n.code,{children:"@paima/db"}),"):"]})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"getAddressByAddress"}),": Fetches account information for a specific wallet address."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"getAddressByAccountId"}),": Fetches all addresses linked to a specific account ID."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"getAccountById"}),": Fetches the details of a specific account, including its primary address."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},6613:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>d});var r=s(1491);const i={},t=r.createContext(i);function a(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);