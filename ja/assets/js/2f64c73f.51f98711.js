"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[6492],{1623:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"home/chains/bitcoin","title":"Bitcoin","description":"Effectstream supports connecting directly to the Bitcoin network (including Regtest for development). This allows you to build dApps that react to native Bitcoin transactions, such as ordinals, runes, or standard payments.","source":"@site/docs/home/200-chains/205-bitcoin.md","sourceDirName":"home/200-chains","slug":"/home/chains/bitcoin","permalink":"/docs/ja/home/chains/bitcoin","draft":false,"unlisted":false,"editUrl":"https://github.com/PaimaStudios/paima-engine-docs/tree/main/docs/home/200-chains/205-bitcoin.md","tags":[],"version":"current","sidebarPosition":205,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Avail","permalink":"/docs/ja/home/chains/avail"},"next":{"title":"Polkadot & Substrate","permalink":"/docs/ja/home/chains/polkadot"}}');var o=t(2531),r=t(6613);const s={},c="Bitcoin",a={},d=[{value:"1. Configuration (Read)",id:"1-configuration-read",level:2},{value:"Network Definition",id:"network-definition",level:3},{value:"Sync Protocol",id:"sync-protocol",level:3},{value:"Primitives",id:"primitives",level:3},{value:"2. Batcher Adapters (Write)",id:"2-batcher-adapters-write",level:2},{value:"Bitcoin Adapter",id:"bitcoin-adapter",level:3},{value:"3. Orchestration",id:"3-orchestration",level:2}];function l(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"bitcoin",children:"Bitcoin"})}),"\n",(0,o.jsx)(n.p,{children:"Effectstream supports connecting directly to the Bitcoin network (including Regtest for development). This allows you to build dApps that react to native Bitcoin transactions, such as ordinals, runes, or standard payments."}),"\n",(0,o.jsx)(n.h2,{id:"1-configuration-read",children:"1. Configuration (Read)"}),"\n",(0,o.jsx)(n.h3,{id:"network-definition",children:"Network Definition"}),"\n",(0,o.jsx)(n.p,{children:"Configure the connection to a Bitcoin Core node (RPC)."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'.buildNetworks(builder =>\n  builder.addNetwork({\n    name: "bitcoin",\n    type: ConfigNetworkType.BITCOIN,\n    rpcUrl: "http://127.0.0.1:18443",\n    rpcAuth: {\n      username: "dev",\n      password: "devpassword",\n    },\n    network: "regtest", // or mainnet, testnet\n  })\n)\n'})}),"\n",(0,o.jsx)(n.h3,{id:"sync-protocol",children:"Sync Protocol"}),"\n",(0,o.jsxs)(n.p,{children:["Use ",(0,o.jsx)(n.code,{children:"BITCOIN_RPC_PARALLEL"})," to poll the Bitcoin node for blocks."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'.addParallel(\n  (networks) => networks.bitcoin,\n  (network, deployments) => ({\n    name: "parallelBitcoin",\n    type: ConfigSyncProtocolType.BITCOIN_RPC_PARALLEL,\n    rpcUrl: "http://127.0.0.1:18443",\n    startBlockHeight: 0,\n    pollingInterval: 10_000,\n    confirmationDepth: 1,\n  })\n)\n'})}),"\n",(0,o.jsx)(n.h3,{id:"primitives",children:"Primitives"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"PrimitiveTypeBitcoinAddress"})}),": Monitors a specific Bitcoin address, where some pattern as (P2PKH, P2WPKH, etc.) can be implemented, for incoming or outgoing transactions."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'import { PrimitiveTypeBitcoinAddress } from "@effectstream/sm/builtin";\n\n.addPrimitive(\n  (syncProtocols) => syncProtocols.parallelBitcoin,\n  (network, deployments, syncProtocol) => ({\n    name: "Watch-System-Wallet",\n    type: PrimitiveTypeBitcoinAddress,\n    watchAddress: "bcrt1qfv6m6l5s6cgda09yr5nd8rnufkaz59d3aquq03", // Bech32 address\n    stateMachinePrefix: "bitcoin-tx",\n  })\n)\n'})}),"\n",(0,o.jsx)(n.h2,{id:"2-batcher-adapters-write",children:"2. Batcher Adapters (Write)"}),"\n",(0,o.jsxs)(n.p,{children:["To submit transactions to Bitcoin (e.g., for settlement or payments), you use the ",(0,o.jsx)(n.code,{children:"BitcoinAdapter"}),"."]}),"\n",(0,o.jsx)(n.h3,{id:"bitcoin-adapter",children:"Bitcoin Adapter"}),"\n",(0,o.jsxs)(n.p,{children:["This adapter manages UTXO selection, transaction building (PSBT), and signing using ",(0,o.jsx)(n.code,{children:"bitcoinjs-lib"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'import { BitcoinAdapter } from "@effectstream/batcher";\n\nconst bitcoinAdapter = new BitcoinAdapter({\n  rpcUrl: "http://127.0.0.1:18443",\n  rpcUser: "dev",\n  rpcPass: "devpassword",\n  seed: "your-wallet-seed-phrase", // Used to derive keys for signing\n  network: "regtest"\n});\n'})}),"\n",(0,o.jsx)(n.h2,{id:"3-orchestration",children:"3. Orchestration"}),"\n",(0,o.jsxs)(n.p,{children:["Use ",(0,o.jsx)(n.code,{children:"launchBitcoin"})," from ",(0,o.jsx)(n.code,{children:"@effectstream/orchestrator/start-bitcoin"}),". This spins up a local ",(0,o.jsx)(n.strong,{children:"Bitcoin Core"})," node in regtest mode."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'// in start.ts\nprocessesToLaunch: [\n  ...launchBitcoin("@my-project/bitcoin-contracts"),\n]\n'})}),"\n",(0,o.jsx)(n.p,{children:"It is also common to include a process to mine blocks automatically in the background to ensure transaction processing during development."}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["NOTE: To use this launcher you need to implement some ",(0,o.jsx)(n.code,{children:"deno task"})," in your project. A working implementation is provided in the ",(0,o.jsx)(n.code,{children:"template generator"}),", ",(0,o.jsx)(n.code,{children:"templates"})," or ",(0,o.jsx)(n.code,{children:"e2e tests"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "name": "@e2e/bitcoin-contracts",\n  ...\n  "tasks": {\n    "chain:start": "deno run -A @effectstream/bitcoin-core",\n    "chain:wait": "wait-on tcp:18443",\n    "generate:blocks": "deno run -A ./generate-blocks.ts",\n    "wait-for-block": "deno run -A wait-for-block.ts"\n  }\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},6613:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>c});var i=t(1491);const o={},r=i.createContext(o);function s(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);